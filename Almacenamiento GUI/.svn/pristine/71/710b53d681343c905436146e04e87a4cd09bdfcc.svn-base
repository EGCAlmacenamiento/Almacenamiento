package services;

import javax.transaction.Transactional;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.util.Assert;

import repositories.ItemStockInWarehouseRepository;
import security.Authority;
import utilities.DPMessage;
import utilities.DPUtils;
import domain.ItemStockInWarehouse;

@Service
@Transactional
public class ItemStockInWarehouseService {
	// Managed Repository ------------------------------
	@Autowired
	private ItemStockInWarehouseRepository itemStockInWarehouseRepository;
	
	
	// Supporting Services -----------------------------
	
	
	// Constructors ------------------------------------
	public ItemStockInWarehouseService(){
		super();
	}
	
	// Simple CRUD Methods -----------------------------
	public ItemStockInWarehouse save(ItemStockInWarehouse itemStockInWarehouse) {
		return itemStockInWarehouseRepository.save(itemStockInWarehouse);		
	}
	
	// Other Business Methods ---------------------------
	
	
	// REQ 17.5 - Change the quantity that a warehouse stores of a given item.
	// REQ 18.4 - Remove some units of an item from a warehouse to serve an item in an order.
	public ItemStockInWarehouse modifyQuantityItemInWarehouse(int itemId, int warehouseId ,int newQuantity) {
		Assert.isTrue(DPUtils.hasRole(Authority.ADMIN, Authority.CLERK), DPMessage.NO_PERMISSIONS);
		ItemStockInWarehouse itemStockInWarehouse = itemStockInWarehouseRepository.getItemStockInWarehouse(itemId, warehouseId);
		itemStockInWarehouse.setQuantity(newQuantity);
		return itemStockInWarehouseRepository.save(itemStockInWarehouse);
	}	
}